# Project Overview
## Purpose: Build backend for the web app of emoji maker
Tech Stack
Next.js
Supabase
Clerk
## Database Schema
Supabase Storage Bucket: "emojis"
Table: emojis
id: BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY
image_url: TEXT NOT NULL
prompt: TEXT NOT NULL
likes_count: NUMERIC DEFAULT 0
creator_user_id: TEXT NOT NULL
created_at: TIMESTAMP WITH TIME ZONE DEFAULT NOW()
Table: profiles
user_id: TEXT PRIMARY KEY
credits: INTEGER DEFAULT 3 NOT NULL
tier: TEXT NOT NULL DEFAULT 'free' CHECK (tier IN ('free', 'pro'))
stripe_customer_id: TEXT
stripe_subscription_id: TEXT
created_at: TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP NOT NULL
updated_at: TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP NOT NULL

# Requirements
1. Create user to user table
After a user signin via clerk, we should get the userId from clerk, and check if this userId exist in 'profiles' table, matching "user_id"
if the user doesnt exist, then create a user in 'profiles' table
if the user exist already, then proceed, and pass on user_id to functions like generate emojis
2. Upload emoji to "emojis" supabase storage bucket:
When user generating an emoji, upload the emoji image file returned from Replicate to supabase "emojis" storage bucket
Add a row to 'emojis' table where the image url to te "emojis" data table as "image_url", and creator_user_id to be the actual user_id
3. Display all images in emojigrid
Emoji grid should fetch and display all images from "emojis" data table
when a new emoji is generated, the emojigrid should be updated automatically to add the new emoji to the grid
4. Likes interaction
When user check on 'like' button, the num_likes should increase on the 'emojis' table
when user un-check 'like' button, the num_likes should decrease on the 'emojis' table

# Documentation
Example of uploading files to supabase storage:
import { createClient } from '@supabase/supabase-js'

// Create Supabase client
const supabase = createClient('your_project_url', 'your_supabase_api_key')

// Upload file using standard upload
async function uploadFile(file) {
  const { data, error } = await supabase.storage.from('bucket_name').upload('file_path', file)
  if (error) {
    // Handle error
  } else {
    // Handle success
  }
}

